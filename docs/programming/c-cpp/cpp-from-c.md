# 从 C 到 C++

恭喜你完成了 C 语言核心基础的学习！现在，我们将踏入 C++ 的世界。C++ 最初被称为"带类的 C"，它的设计初衷就是成为 C 的一个**超集 (superset)**。这意味着几乎所有合法的 C 代码也都是合法的 C++ 代码。

然而，C++ 引入了大量新特性和编程范式，极大地增强了语言的表达能力和安全性。本章将作为一座桥梁，介绍从 C 转向 C++ 时最先会遇到的一些关键变化。

## 1. 第一个 C++ 程序 "Hello, World!"

我们用 C++ 的方式重写 "Hello, World!"，直观地感受一下不同之处。

```cpp
// C++ 推荐使用 .cpp 作为源文件扩展名
#include <iostream> // 1. 新的头文件

// 2. 使用命名空间
// using namespace std; 

int main() {
    // 3. 新的输出方式
    std::cout << "Hello, World!" << std::endl; 
    
    return 0;
}
```
让我们来解析这几个核心变化。

## 2. 头文件与 `<iostream>`

在 C++ 中，C 语言的标准库头文件（如 `<stdio.h>`, `<stdlib.h>`）依然可用。但 C++ 提供了它自己的、类型更安全的 I/O 库 `<iostream>`。

- **C 风格**: `#include <stdio.h>`
- **C++ 风格**: `#include <iostream>`

C++ 的标准库头文件通常不带 `.h` 后缀。同时，为了兼容 C，C++ 也提供了 C 标准库的 C++ 版本，命名方式是在 C 头文件名去掉 `.h` 并在前面加上 `c`，例如 `<cstdio>`, `<cstdlib>`。

## 3. 命名空间 (Namespace)

命名空间是 C++ 为了解决**命名冲突**问题而引入的一个重要特性。在大型项目中，不同的库或模块可能会定义相同的函数名或变量名（例如，两个库都定义了一个叫 `log` 的函数），这在 C 语言中会导致链接错误。

命名空间为标识符（变量名、函数名、类名等）提供了一个作用域。C++ 标准库的所有内容都被定义在一个名为 `std` 的命名空间中。

要访问 `std` 命名空间中的成员，有两种主要方式：

### a. 使用 `std::` 前缀 (推荐)

通过作用域解析运算符 `::` 来明确指定你要使用的 `cout` 是 `std` 命名空间里的那个。

`std::cout << "Hello!";`

这是最安全、最清晰的方式，因为它明确地表明了标识符的来源，不会污染全局命名空间。

### b. 使用 `using` 指令

`using namespace std;`

这行代码告诉编译器，"在本文件中，我将使用 `std` 命名空间中的所有成员，所以请把它们都当作全局成员一样对待"。这样，你就可以直接写 `cout` 而不是 `std::cout`。

这种方式在小程序或学习时很方便，但在大型项目中**不推荐**在头文件中使用，因为它会将 `std` 中的所有名称（成百上千个）都暴露到全局作用域中，增加了命名冲突的风险。

## 4. `cout`, `cin`, `endl`：类型安全的流式 I/O

`printf` 和 `scanf` 是 C 语言强大但类型不安全的 I/O 工具。你必须手动确保格式说明符（如 `%d`, `%f`, `%s`）与变量的实际类型匹配，否则会导致未定义行为。

C++ 的 `<iostream>` 引入了基于**流 (stream)** 的 I/O 概念，它更安全、更具扩展性。

- **`std::cout`**: 标准输出流 (character output stream)，对应于控制台。
- **`std::cin`**: 标准输入流 (character input stream)，对应于键盘。
- **`<<`**: 流插入运算符，用于将数据"插入"到输出流中。
- **`>>`**: 流提取运算符，用于从输入流中"提取"数据。
- **`std::endl`**: 一个操纵符 (manipulator)，用于向输出流插入一个换行符 `\n`，并**刷新 (flush)** 输出缓冲区。

```cpp
#include <iostream>
#include <string> // C++ 的字符串类型

int main() {
    int age;
    std::string name; // 使用 C++ string 类型

    std::cout << "请输入你的名字: ";
    // std::cin >> name; // cin 遇到空格会停止
    std::getline(std::cin, name); // 读取一整行

    std::cout << "请输入你的年龄: ";
    std::cin >> age;

    std::cout << "你好, " << name 
              << "! 你今年 " << age << " 岁。" 
              << std::endl;
    
    return 0;
}
```
`cout` 和 `cin` 的美妙之处在于它们是**类型安全**的。你不需要告诉它们你要处理的是整数、浮点数还是字符串，它们会通过函数重载自动选择正确的版本来处理数据。

## 5. 其他从 C 到 C++ 的小变化

- **注释**: C++ 推荐使用 `//` 进行单行注释，虽然 `/* ... */` 仍然可用。
- **`const` 的广泛使用**: C++ 中更倾向于使用 `const` 关键字来定义常量，而不是 `#define`，因为它提供了类型安全。
- **更严格的类型检查**: C++ 的类型检查比 C 更严格。例如，`void*` 指针不能在不进行显式强制转换的情况下赋值给其他类型的指针。

---

这些只是 C++ 在 C 基础之上所做改进的冰山一角。掌握了这些基础的过渡知识后，我们就可以开始学习 C++ 最核心的特性、也是其与 C 最大的区别所在：[类与对象](cpp-classes-objects.md)。 