# 1. 分布式系统简介

## 什么是分布式系统？

分布式系统是一个由多台独立的计算机（称为**节点/Node**）组成的集合，这些计算机通过网络进行通信和协作，共同完成一个任务。从外部用户的角度来看，整个系统就像一台功能强大的单一计算机。

我们每天都在与分布式系统交互，例如：
- 使用搜索引擎时，背后是数以万计的服务器在协同工作。
- 在电商网站购物时，商品信息、订单、支付等服务都由不同的分布式系统处理。
- 刷社交媒体时，内容的分发和存储都依赖于全球分布的服务器集群。

## 为什么需要分布式系统？

从单体应用走向分布式系统的核心驱动力是为了克服单台计算机的物理和性能限制。

1.  **高扩展性 (Scalability)**:
    - **垂直扩展 (Vertical Scaling)**: 增强单个服务器的性能（如增加CPU、内存）。这种方式成本高昂，且存在物理上限。
    - **水平扩展 (Horizontal Scaling)**: 通过增加更多的普通计算机节点来扩展系统的整体处理能力。这是分布式系统最核心的优势，理论上可以实现无限的扩展。

2.  **高可用性 (High Availability)**:
    单台计算机总有发生故障的风险（硬件损坏、软件崩溃、网络中断）。在分布式系统中，如果一个节点发生故障，其他节点可以接管它的工作，从而保证整个系统持续提供服务。通过数据冗余和故障转移机制，分布式系统可以实现接近100%的可用性。

3.  **高性能 (High Performance)**:
    分布式系统可以将一个庞大的计算任务分解成多个子任务，交由不同的节点并行处理，从而极大地缩短任务的响应时间。例如，MapReduce框架就是为并行处理海量数据集而设计的。

4.  **成本效益 (Cost-Effectiveness)**:
    使用大量廉价的、商品化的硬件（Commodity Hardware）来构建一个强大的集群，通常比购买和维护一台同等性能的高端小型机或大型机要便宜得多。

## 分布式系统的挑战

构建和管理分布式系统并非易事，它引入了许多单体系统不存在的复杂挑战：

- **节点故障 (Node Failure)**: 节点可能会随时崩溃或变得无响应。系统必须能够检测到故障并从中恢复。
- **网络问题 (Network Issues)**:
    - **网络分区 (Network Partition)**: 网络可能发生割裂，导致一部分节点无法与另一部分节点通信，形成"孤岛"。这是分布式系统中最棘手的问题之一。
    - **网络延迟 (Latency)**: 节点间的通信存在延迟，这使得状态同步和操作排序变得复杂。
    - **带宽限制 (Bandwidth)**: 节点间的数据传输能力是有限的。
- **并发与一致性 (Concurrency and Consistency)**:
    多个客户端可能同时读写同一份数据。如何在保证数据正确性（一致性）的同时，最大限度地提高并发性能，是分布式数据存储的核心难题。
- **时钟同步 (Clock Synchronization)**:
    每个节点的本地时钟都存在偏差，没有一个全局统一的、完全精确的时钟。这给确定事件的先后顺序带来了挑战。分布式系统通常依赖逻辑时钟（如Lamport时间戳、向量时钟）来解决这个问题。
- **数据管理**:
    如何将数据有效地分布到各个节点？如何保证数据的冗余备份？当增加或删除节点时，如何进行数据的迁移？

## 分布式存储系统

分布式存储系统是分布式系统的一个重要分支，它专门解决海量数据的存储和访问问题。它将数据分散存储在多个节点上，共同构成一个统一的存储池。

根据数据模型的不同，分布式存储系统通常分为三类：
1.  **分布式文件系统**: 将文件（特别是大文件）分块存储在不同节点上，如 HDFS, CephFS。
2.  **分布式键值/NoSQL存储**: 以键值对、列族、文档等形式存储数据，如 Cassandra, TiKV, DynamoDB。
3.  **对象存储**: 将数据作为不可变的对象进行存储，通过唯一的ID进行访问，如 MinIO, Ceph Rados Gateway。

接下来的章节，我们将深入探讨支撑这些系统的核心理论和关键技术，首先从著名的 [CAP理论与BASE理论](cap-base-theorem.md) 开始。 