# 2. Linux 安装与启动

安装 Linux 是学习和使用它的第一步。本章将介绍几种常见的安装方法，并概述一个典型的安装过程和系统的启动流程。

## 选择安装方式

根据你的需求和现有环境，可以选择不同的方式来安装和体验 Linux。

### 1. 虚拟机 (Virtual Machine) - 推荐初学者

这是最安全、最方便的方式，尤其适合初学者和需要在现有操作系统（如 Windows 或 macOS）中测试 Linux 的用户。

- **工作原理**：使用虚拟机软件（如 [VirtualBox](https://www.virtualbox.org/) 或 [VMware Workstation Player](https://www.vmware.com/products/workstation-player.html)）在当前的操作系统内创建一个虚拟的计算机，你可以在这个虚拟计算机上安装和运行整个 Linux 系统。
- **优点**：
    - **安全隔离**：不会影响你现有的主操作系统。可以随意折腾，即使搞坏了，删除虚拟机即可。
    - **快照功能**：可以随时保存虚拟机的状态，方便回滚到之前的状态。
    - **同时运行**：可以同时运行主系统和 Linux，方便切换和资料共享。
- **缺点**：
    - **性能损耗**：因为是虚拟化运行，性能会比物理机安装略低。
    - **硬件访问受限**：对特定硬件（如 GPU、Wi-Fi 适配器）的直接访问可能受限。

### 2. Windows Subsystem for Linux (WSL) - 推荐开发者

WSL 是微软官方提供的在 Windows 10/11 上运行原生 Linux 环境的功能，特别适合需要在 Windows 上进行 Linux 开发的开发者。

- **工作原理**：WSL 2 使用了一个轻量级的虚拟机来运行完整的 Linux 内核，提供了非常高的性能和系统调用兼容性。
- **优点**：
    - **无缝集成**：可以从 Windows 的命令行（cmd 或 PowerShell）直接访问 Linux Shell，也可以在 Linux 中访问 Windows 的文件系统。
    - **性能优异**：文件系统和网络性能远超传统虚拟机。
    - **安装简单**：通过几条命令即可从 Microsoft Store 安装 Ubuntu、Debian 等多种发行版。
- **缺点**：
    - **非完整桌面体验**：默认不提供图形用户界面（GUI），虽然可以通过安装 X Server 来实现，但主要面向命令行操作。
    - **硬件支持有限**：不适合需要直接访问底层硬件的任务。

### 3. 双系统启动 (Dual Boot)

这意味着在你的计算机上同时安装两个独立的操作系统（例如 Windows 和 Ubuntu）。每次开机时，你可以选择进入哪个系统。

- **工作原理**：将硬盘划分出新的分区，将 Linux 安装在一个独立的分区上。开机时由引导加载程序（如 GRUB）提供一个选择菜单。
- **优点**：
    - **最佳性能**：Linux 直接运行在物理硬件上，可以完全利用所有硬件资源，性能最好。
    - **完整的硬件支持**：可以访问所有硬件设备。
- **缺点**：
    - **风险较高**：分区操作有风险，如果操作不当，可能会损坏现有系统的数据。**操作前务必备份重要数据！**
    - **切换不便**：需要重启电脑才能在两个系统之间切换。
    - **安装过程相对复杂**：需要处理硬盘分区、Secure Boot 等问题。

### 4. U盘/Live CD 体验

许多 Linux 发行版提供 "Live" 镜像，可以将其写入 U 盘。从 U 盘启动后，你可以在不安装的情况下直接运行和体验完整的 Linux 桌面环境。

- **优点**：
    - **零风险**：完全不修改你的硬盘数据。
    - **便携**：可以把你的 Linux 系统带到任何电脑上使用。
- **缺点**：
    - **性能受限**：受 U 盘读写速度影响，性能较差。
    - **更改不会保存**：默认情况下，重启后所有更改都会丢失（除非配置了持久化存储）。

## 典型安装过程 (以 Ubuntu 桌面版为例)

以下是在虚拟机或物理机上安装 Ubuntu 的一个通用步骤。

1.  **下载 ISO 镜像**：
    - 访问 [Ubuntu 官方网站](https://ubuntu.com/download/desktop)，下载最新的桌面版 (Desktop) ISO 镜像文件。

2.  **创建启动介质**：
    - **虚拟机**：直接在虚拟机软件中新建一个虚拟机，并将下载的 ISO 文件作为虚拟光驱加载。
    - **物理机**：准备一个空白 U 盘（至少 8GB）。使用 [Rufus](https://rufus.ie/) 或 [balenaEtcher](https://www.balena.io/etcher/) 这样的工具，将 ISO 镜像文件写入 U 盘，制作成一个可启动的安装盘。

3.  **从启动介质启动**：
    - **虚拟机**：启动创建的虚拟机。
    - **物理机**：将 U 盘插入电脑，重启电脑。在开机画面出现时，按下特定键（通常是 `F2`, `F10`, `F12`, `DEL` 或 `ESC`）进入 BIOS/UEFI 设置，将启动顺序（Boot Order）修改为优先从 U 盘启动。

4.  **开始安装**：
    - 启动后，你会看到一个欢迎界面。选择 "Try Ubuntu" (试用) 或 "Install Ubuntu" (安装)。
    - **语言选择**：选择你希望在安装过程和未来系统中使用的语言。
    - **键盘布局**：选择你的键盘布局。
    - **网络连接**：可以连接到 Wi-Fi 网络，以便在安装过程中下载更新。
    - **更新和软件**：
        - **正常安装**：安装网页浏览器、办公软件、游戏和媒体播放器。
        - **最小安装**：只安装最基本的工具和网页浏览器。
        - **为图形或无线硬件安装第三方软件**：如果你的电脑有特殊的显卡（如 NVIDIA）或 Wi-Fi 芯片，建议勾选此项。
    - **安装类型 (最关键的一步)**：
        - **与 Windows Boot Manager 共存**：如果检测到现有 Windows 系统，安装程序会自动提供此选项，为你调整分区并设置双系统。这是最简单的双系统安装方式。
        - **清除整个磁盘并安装 Ubuntu**：**警告！这将删除硬盘上的所有数据！** 仅在确定该硬盘可以完全专用于 Linux 时选择。
        - **其他选项 (Something else)**：手动分区。这适合高级用户，你可以完全控制分区的大小、类型（ext4, swap）和挂载点（`/`, `/home`, `/boot`）。

5.  **设置地区和用户**：
    - **选择时区**：在地图上选择你所在的地区。
    - **创建用户**：设置你的用户名、计算机名和密码。

6.  **完成安装**：
    - 点击 "Install Now" 后，安装过程将开始自动进行文件复制和系统配置。
    - 安装完成后，会提示你重启计算机。按提示重启，并移除安装介质（U 盘）。

## Linux 启动过程简介

当你按下电源按钮后，计算机到显示 Linux 登录界面之间发生了一系列复杂的步骤。

1.  **BIOS / UEFI**：
    - 计算机通电后，首先运行的是主板固件，即 BIOS (基本输入输出系统) 或其现代替代品 UEFI (统一可扩展固件接口)。
    - 固件进行 **POST (Power-On Self-Test)**，即开机自检，检查硬件（内存、CPU等）是否工作正常。
    - 检查完成后，固件会根据设定的启动顺序，查找可启动的设备（如硬盘、U盘）。

2.  **主引导记录 (MBR) / EFI 分区 (ESP)**：
    - **传统 BIOS**：读取硬盘的第一个扇区，即 **MBR (Master Boot Record)**。MBR 中包含一小段代码（引导加载程序的第一阶段）和分区表。
    - **现代 UEFI**：从硬盘上的一个特殊FAT32分区，即 **ESP (EFI System Partition)**，加载引导程序文件（`.efi` 文件）。

3.  **引导加载程序 (Boot Loader)，例如 GRUB**：
    - **GRUB (GRand Unified Bootloader)** 是最常见的 Linux 引导加载程序。
    - GRUB 被加载后，会显示一个菜单（如果安装了多系统），让你选择要启动的操作系统或内核版本。
    - 如果你不做选择，倒计时结束后，它会自动加载默认的操作系统。

4.  **加载 Linux 内核 (Kernel)**：
    - GRUB 将选定的 Linux 内核（通常是一个名为 `vmlinuz` 的文件）和 **initramfs (initial RAM filesystem)** 加载到内存中。
    - `initramfs` 是一个临时的根文件系统，它包含了启动过程中必需的驱动程序和工具（例如硬盘驱动），以便内核能够访问真正的根文件系统。

5.  **启动 init 进程**：
    - 内核被加载并初始化硬件后，它会启动系统的第一个用户空间进程，即 **`init`** 进程（其进程ID，PID，永远是1）。
    - 在现代 Linux 系统中，`init` 进程通常是 **`systemd`**。
    - `systemd` 负责读取其配置文件，并按顺序或并行地启动所有系统服务（如网络服务、图形界面服务、数据库服务等）。

6.  **登录界面 (Login)**：
    - `systemd` 启动所有必要的服务后，最后会启动一个登录管理器（如 GDM for GNOME, SDDM for KDE），显示图形化的登录界面，或者在服务器上显示一个文本模式的登录提示符。
    - 你输入用户名和密码后，系统验证通过，为你启动一个 Shell 会话或桌面环境，至此，系统完全启动成功。 